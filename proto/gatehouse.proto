syntax = "proto3";
package gatehouse;

import "targets.proto";

/** The list of values tied to an attribute */
message AttributeValues {
    // the list of values
    repeated string values = 1;
}

/** Describes an entity and its attributes that will be tested against policies for a target */
message Entity {
    // the identity of the entity (case insensitive)
    // ex: "johndoe@email.com"
    string id = 1;

    // type string (case insensitive)
    // ex: "email"
    string type = 2;

    // entity attributes
    map<string, AttributeValues> attributes = 3;
}

/** The main Gatehouse server */
service Gatehouse {
    // add a new target 
    rpc AddTarget (targets.AddTargetRequest) returns (targets.TargetResponse);

    // add an action to an existing target
    rpc ModifyTarget (targets.ModifyTargetRequest) returns (targets.TargetResponse);

    // remove an existing target
    rpc RemoveTarget(targets.RemoveTargetRequest) returns (targets.TargetResponse);

    // get all existing targets
    rpc GetTargets(targets.GetAllTargetsRequest) returns (targets.MultiTargetResponse);
}